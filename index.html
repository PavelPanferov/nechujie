<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ближе - Игра для пар</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --secondary-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #a8edea 100%);
            --accent-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ff9a9e 75%, #fecfef 100%);
            --glass-bg: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --text-light: rgba(255, 255, 255, 0.6);
            --card-shadow: 0 30px 80px rgba(102, 126, 234, 0.2);
            --border-glass: rgba(255, 255, 255, 0.2);
            --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #0a0118;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at center,
                rgba(102, 126, 234, 0.4) 0%,
                rgba(240, 147, 251, 0.3) 25%,
                rgba(255, 154, 158, 0.2) 50%,
                transparent 75%);
            animation: rotate 25s linear infinite;
            z-index: -2;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(240, 147, 251, 0.15) 0%, transparent 60%),
                radial-gradient(circle at 40% 60%, rgba(102, 126, 234, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Particles */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            pointer-events: none;
        }

        .heart-particle {
            color: rgba(240, 147, 251, 0.7);
            animation: float 12s ease-in-out infinite;
        }

        .star-particle {
            color: rgba(255, 255, 255, 0.5);
            animation: twinkle 4s ease-in-out infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% {
                transform: translateY(-100px) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        .container {
            width: 100%;
            max-width: 420px;
            position: relative;
            z-index: 10;
        }

        /* Screens */
        .screen {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--border-glass);
            border-radius: 32px;
            padding: 50px 35px;
            box-shadow: var(--card-shadow);
            animation: slideUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--primary-gradient);
            border-radius: 32px 32px 0 0;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Logo and title */
        .logo-container {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .logo {
            font-size: 4em;
            margin-bottom: 20px;
            display: inline-block;
            animation: heartbeat 3s ease-in-out infinite;
            filter: drop-shadow(0 4px 12px rgba(240, 147, 251, 0.4));
        }

        @keyframes heartbeat {
            0%, 70%, 100% {
                transform: scale(1) rotate(0deg);
            }
            10% {
                transform: scale(1.15) rotate(-3deg);
            }
            20% {
                transform: scale(1.08) rotate(2deg);
            }
        }

        h1 {
            font-size: 3.2em;
            font-weight: 800;
            background: var(--primary-gradient);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 4s linear infinite;
            margin-bottom: 12px;
            letter-spacing: -0.03em;
        }

        @keyframes gradient {
            to { background-position: 200% center; }
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1.2em;
            letter-spacing: 3px;
            text-transform: uppercase;
            font-weight: 400;
            opacity: 0.9;
        }

        /* Level buttons */
        .level-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 30px;
        }

        .level-btn {
            width: 100%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            color: var(--text-primary);
            padding: 28px 24px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-align: left;
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.15);
        }

        .level-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent);
            transition: left 0.8s ease;
        }

        .level-btn:hover::before {
            left: 100%;
        }

        .level-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.25);
        }

        .level-btn:active {
            transform: translateY(2px);
        }

        .level-btn.special {
            background: linear-gradient(135deg,
                rgba(255, 154, 158, 0.15),
                rgba(168, 237, 234, 0.15));
            border-color: rgba(255, 154, 158, 0.3);
        }

        .level-icon {
            font-size: 2em;
            margin-bottom: 12px;
            display: block;
            filter: drop-shadow(0 2px 8px rgba(240, 147, 251, 0.3));
        }

        .level-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .level-desc {
            font-size: 0.95em;
            color: var(--text-light);
            opacity: 0.8;
            line-height: 1.4;
        }

        .progress-indicator {
            position: absolute;
            top: 16px;
            right: 20px;
            background: var(--primary-gradient);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.8em;
            font-weight: 600;
            min-width: 28px;
            text-align: center;
        }

        .progress-indicator.completed {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .progress-indicator.in-progress {
            background: linear-gradient(135deg, #FF9800, #f57c00);
        }

        /* Settings button */
        .settings-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-glass);
            color: var(--text-secondary);
            padding: 14px 28px;
            border-radius: 25px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Game card */
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--border-glass);
            border-radius: 28px;
            padding: 45px 35px;
            min-height: 350px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(240, 147, 251, 0.05) 100%);
            pointer-events: none;
        }

        .card-header {
            position: absolute;
            top: 20px;
            left: 25px;
            right: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 2;
        }

        .level-badge {
            background: var(--primary-gradient);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .card-counter {
            color: var(--text-light);
            font-size: 0.95em;
            font-weight: 500;
        }

        .question-text {
            color: var(--text-primary);
            font-size: 1.4em;
            line-height: 1.6;
            text-align: center;
            font-weight: 500;
            padding: 20px 10px;
            position: relative;
            z-index: 1;
            letter-spacing: -0.01em;
        }

        .task-card {
            background: var(--accent-gradient);
            color: var(--text-primary);
            padding: 35px 30px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            position: relative;
            z-index: 1;
            box-shadow: 0 15px 40px rgba(168, 237, 234, 0.3);
        }

        .task-icon {
            font-size: 3.5em;
            margin-bottom: 18px;
            display: block;
            animation: iconFloat 5s ease-in-out infinite;
            filter: drop-shadow(0 4px 8px rgba(102, 126, 234, 0.2));
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-12px) rotate(8deg); }
        }

        .task-text {
            color: var(--text-primary);
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .task-time {
            color: rgba(26, 32, 44, 0.7);
            font-size: 0.95em;
            font-weight: 500;
        }

        /* Comparison mode */
        .comparison-choices {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 30px 0;
            position: relative;
            z-index: 1;
        }

        .choice-btn {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-glass);
            color: var(--text-primary);
            padding: 24px 28px;
            border-radius: 20px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .choice-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .choice-btn:hover {
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .choice-btn:hover::before {
            left: 100%;
        }

        .choice-btn.selected {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            transform: translateY(-2px) scale(1.02);
        }

        .player2-btn.selected {
            background: var(--secondary-gradient);
            box-shadow: 0 15px 40px rgba(255, 154, 158, 0.4);
        }

        /* Navigation */
        .nav-container {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .nav-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4em;
            transition: var(--transition);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.25);
        }

        .nav-btn:active {
            transform: translateY(1px);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        .nav-btn.primary {
            background: var(--primary-gradient);
            border: none;
            color: white;
            font-size: 1.6em;
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.3);
        }

        /* Progress bar */
        .progress {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .progress::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 15px;
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progressShine 4s infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* Name input screen */
        .name-inputs {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .input-group label {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .input-group input {
            padding: 16px 20px;
            border: 2px solid var(--border-glass);
            border-radius: 16px;
            font-size: 1em;
            font-family: inherit;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            transition: var(--transition);
            outline: none;
        }

        .input-group input:focus {
            border-color: rgba(102, 126, 234, 0.8);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .input-group input::placeholder {
            color: var(--text-light);
            opacity: 0.7;
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        /* Card animations */
        @keyframes cardFlipIn {
            from {
                transform: rotateY(90deg) scale(0.9);
                opacity: 0;
            }
            to {
                transform: rotateY(0) scale(1);
                opacity: 1;
            }
        }

        .card-flip-in {
            animation: cardFlipIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Mobile optimizations */
        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
                max-width: 100%;
            }

            .screen {
                padding: 35px 25px;
            }

            h1 {
                font-size: 2.8em;
            }

            .question-text {
                font-size: 1.3em;
            }

            .card {
                padding: 35px 25px;
                min-height: 320px;
            }

            .level-btn {
                padding: 24px 20px;
                font-size: 1em;
            }

            .nav-container {
                gap: 12px;
            }

            .nav-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2em;
            }
        }

        @media (hover: hover) {
            .level-btn:hover {
                transform: translateY(-6px);
                box-shadow: 0 25px 60px rgba(102, 126, 234, 0.3);
            }

            .choice-btn:hover {
                transform: translateY(-6px);
            }

            .nav-btn:hover {
                transform: translateY(-4px);
            }
        }
    </style>
</head>
<body>
    <div id="particles"></div>

    <div class="container">
        <!-- Start screen -->
        <div class="screen" id="startScreen">
            <div class="logo-container">
                <div class="logo">💕</div>
                <h1>Не чужие</h1>
                <p class="subtitle">Игра для пар</p>
            </div>

            <div class="level-buttons">
                <button class="level-btn" onclick="startGame(1)" id="level1Btn">
                    <div class="level-icon">✨</div>
                    <div class="level-title">Уровень 1: Восприятие</div>
                    <div class="level-desc">Узнайте первые впечатления</div>
                    <span class="progress-indicator" id="progress1"></span>
                </button>

                <button class="level-btn" onclick="startGame(2)" id="level2Btn">
                    <div class="level-icon">💕</div>
                    <div class="level-title">Уровень 2: Связь</div>
                    <div class="level-desc">Создайте эмоциональную близость</div>
                    <span class="progress-indicator" id="progress2"></span>
                </button>

                <button class="level-btn" onclick="startGame(3)" id="level3Btn">
                    <div class="level-icon">🌟</div>
                    <div class="level-title">Уровень 3: Размышления</div>
                    <div class="level-desc">Откройте глубинные чувства</div>
                    <span class="progress-indicator" id="progress3"></span>
                </button>

                <button class="level-btn special" onclick="startGame('tasks')" id="levelTasksBtn">
                    <div class="level-icon">🎯</div>
                    <div class="level-title">Специальные задания</div>
                    <div class="level-desc">Творческие активности для двоих</div>
                    <span class="progress-indicator" id="progressTasks"></span>
                </button>

                <button class="level-btn" onclick="startGame('comparison')" id="levelComparisonBtn">
                    <div class="level-icon">💑</div>
                    <div class="level-title">Ты или Я?</div>
                    <div class="level-desc">Угадайте склонности друг друга</div>
                    <span class="progress-indicator" id="progressComparison"></span>
                </button>
            </div>

            <button class="settings-btn" onclick="showNameInput()">
                ⚙️ Настройки
            </button>
        </div>

        <!-- Name input screen -->
        <div class="screen hidden" id="nameInputScreen">
            <div class="logo-container">
                <div class="logo">👥</div>
                <h1>Знакомство</h1>
                <p class="subtitle">Как вас зовут?</p>
            </div>

            <div class="name-inputs">
                <div class="input-group">
                    <label for="player1Name">Игрок 1:</label>
                    <input type="text" id="player1Name" placeholder="Введите имя" maxlength="15">
                </div>
                <div class="input-group">
                    <label for="player2Name">Игрок 2:</label>
                    <input type="text" id="player2Name" placeholder="Введите имя" maxlength="15">
                </div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" onclick="backToMenu()">←</button>
                <button class="nav-btn primary" onclick="saveNames()">✓</button>
            </div>
        </div>

        <!-- Game screen -->
        <div class="screen hidden" id="gameScreen">
            <div class="card" id="card">
                <div class="card-header">
                    <span class="level-badge" id="levelLabel"></span>
                    <span class="card-counter" id="cardNumber"></span>
                </div>
                <div id="cardContent"></div>
            </div>

            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" id="prevBtn" onclick="previousCard()">←</button>
                <button class="nav-btn" onclick="backToMenu()">🏠</button>
                <button class="nav-btn primary" onclick="nextCard()">→</button>
            </div>
        </div>

        <!-- Comparison screen -->
        <div class="screen hidden" id="comparisonScreen">
            <div class="card" id="comparisonCard">
                <div class="card-header">
                    <span class="level-badge">Ты или Я?</span>
                    <span class="card-counter" id="comparisonCardNumber"></span>
                </div>
                <div class="question-text" id="comparisonQuestion"></div>

                <div class="comparison-choices">
                    <button class="choice-btn player1-btn" id="player1Choice" onclick="makeChoice(1)">
                        <span id="player1ChoiceText">Игрок 1</span>
                    </button>
                    <button class="choice-btn player2-btn" id="player2Choice" onclick="makeChoice(2)">
                        <span id="player2ChoiceText">Игрок 2</span>
                    </button>
                </div>
            </div>

            <div class="progress">
                <div class="progress-bar" id="comparisonProgressBar"></div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" id="comparisonPrevBtn" onclick="previousComparisonCard()">←</button>
                <button class="nav-btn" onclick="backToMenu()">🏠</button>
                <button class="nav-btn primary" id="comparisonNextBtn" onclick="nextComparisonCard()" disabled>→</button>
            </div>
        </div>
    </div>

    <script>
        // Particle effects
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer || particlesContainer.children.length > 0) return;

            for (let i = 0; i < 25; i++) {
                const isHeart = Math.random() > 0.6;
                const particle = document.createElement('div');
                particle.className = isHeart ? 'particle heart-particle' : 'particle star-particle';
                particle.innerHTML = isHeart ? ['💕', '💖', '💗', '💝'][Math.floor(Math.random() * 4)] : ['✨', '⭐', '🌟'][Math.floor(Math.random() * 3)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.fontSize = Math.random() * 12 + 10 + 'px';

                const animationDuration = Math.random() * 8 + 12;
                const animationDelay = Math.random() * 10;

                if (isHeart) {
                    particle.style.animation = `float ${animationDuration}s ease-in-out infinite ${animationDelay}s`;
                } else {
                    particle.style.animation = `twinkle ${Math.random() * 3 + 3}s ease-in-out infinite ${animationDelay}s`;
                }

                particlesContainer.appendChild(particle);
            }
        }

        // Questions data
        const questions = {
            1: [
                "Как ты думаешь, какая у меня была специальность в университете?",
                "Как ты думаешь, я когда-нибудь был(а) безответно влюблен(а)?",
                "Как ты думаешь, мне когда-нибудь разбивали сердце?",
                "Как ты думаешь, я был(а) популярен(на) в школе?",
                "Как ты думаешь, мне больше нравится быть дома или гулять?",
                "Как ты думаешь, я экстраверт или интроверт?",
                "Какое, по-твоему, мое любимое блюдо?",
                "Какой, по-твоему, мой любимый напиток?",
                "Как ты думаешь, я люблю читать книги?",
                "Как ты думаешь, я играю в видеоигры?",
                "Какой, по-твоему, мой любимый цвет?",
                "Как ты думаешь, я жаворонок или сова?",
                "Какую музыку я слушаю чаще всего?",
                "Как ты думаешь, я люблю путешествовать?",
                "Какое мое любимое время года?",
                "Если бы у тебя была возможность поужинать с любым человеком в мире, кого бы ты выбрал(а)?",
                "Хотел(а) бы ты стать знаменитым(ой)? Каким образом?",
                "Перед тем как позвонить, ты репетируешь то, что собираешься сказать?",
                "Что для тебя означает «идеальный день»?",
                "Когда ты в последний раз пел(а) для себя? А для кого-то другого?",
                "Если бы ты мог(ла) дожить до 90 лет и сохранить либо разум, либо тело 30-летнего до последнего дня, что бы ты выбрал(а)?",
                "Есть ли у тебя тайное предчувствие о том, как ты умрешь?",
                "Назови три вещи, которые у нас с тобой общие.",
                "За что в своей жизни ты испытываешь наибольшую благодарность?",
                "Если бы ты мог(ла) изменить что-то в том, как тебя воспитывали, что бы это было?",
                "Расскажи историю своей жизни за четыре минуты, включив как можно больше подробностей.",
                "Если бы завтра ты проснулся(лась) с каким-то новым качеством или способностью, какой бы она была?",
                "Есть ли что-то, о чем ты мечтаешь уже долгое время? Почему ты этого еще не сделал(а)?",
                "Какое твое самое ценное воспоминание?",
                "Какое твое самое ужасное воспоминание?",
                "Какую роль играют любовь и привязанность в твоей жизни?",
                "По очереди поделитесь тем, что считаете положительными качествами партнера. Поделитесь пятью пунктами.",
                "Насколько близка и дружна твоя семья? Чувствуешь ли ты, что детство у тебя было более счастливым, чем у большинства людей?",
                "Как ты относишься к отношениям со своей матерью?"
            ],
            2: [
                "Каким было твое первое впечатление обо мне?",
                "О чем ты солгал(а) мне в последний раз?",
                "Что ты скрывал(а) от меня долгое время?",
                "Какие самые странные мысли приходят тебе в голову?",
                "Какую самую большую ошибку ты совершил(а) в жизни?",
                "Что ты все еще пытаешься доказать себе?",
                "Что самое сложное в отношениях со мной?",
                "Какое твое самое теплое воспоминание из детства?",
                "Что нужно сделать, чтобы завоевать твое доверие?",
                "Какой главный вопрос волнует тебя сейчас?",
                "Что сделало бы тебя еще ближе ко мне?",
                "Чего ты боишься в наших отношениях?",
                "Какой момент стал переломным для нас?",
                "Что бы ты изменил(а) в нашем общении?",
                "Какая моя привычка тебя раздражает?",
                "Какие у тебя сейчас главные цели и стремления?",
                "Что тебя больше всего интересует из того, чем ты не занимался(лась) в прошлом году?",
                "Какой самый большой стресс в твоей жизни прямо сейчас?",
                "Кто твои самые близкие друзья? Расскажи о них.",
                "Какие события из детства сформировали тебя как личность?",
                "Какая твоя самая заветная мечта на будущее?",
                "Что заставляет тебя чувствовать себя по-настоящему живым(ой)?",
                "Как ты справляешься с трудными временами?",
                "Расскажи о моменте, когда ты чувствовал(а) себя особенно любимым(ой) мной.",
                "Какое качество во мне тебе нравится больше всего?",
                "Когда ты в последний раз гордился(лась) мной?",
                "Какой совместный момент был для тебя самым счастливым?",
                "За что ты благодарен(на) мне больше всего?",
                "Что я делаю, что заставляет тебя чувствовать себя особенным(ой)?",
                "Перед кем ты позвонил бы, если бы узнал, что умрешь через час?",
                "Поделись личной проблемой и попроси у партнера совета.",
                "Если бы ты подружился со мной, что было бы важно, чтобы я знал(а)?",
                "Скажи партнеру, что тебе в нем нравится; будь очень честным(ой).",
                "Поделись неловким моментом из своей жизни.",
                "Когда ты в последний раз плакал(а) перед другим человеком? А один?",
                "Что для тебя слишком серьезно, чтобы шутить об этом?"
            ],
            3: [
                "Что ты хочешь изменить в себе прямо сейчас?",
                "Перед кем ты хочешь извиниться?",
                "Что во мне тебя больше всего удивило?",
                "Какая у меня суперсила в отношениях?",
                "Что мне стоит прочитать или посмотреть?",
                "Что ты узнал(а) о себе благодаря нашим отношениям?",
                "Какой вопрос был самым сложным для тебя?",
                "Что было бы идеальным подарком для меня?",
                "Что мне нужно услышать прямо сейчас?",
                "Почему мы встретились именно сейчас?",
                "Что мы можем создать вместе?",
                "Что во мне самое привлекательное помимо внешности?",
                "Как выглядит наша жизнь через 10 лет?",
                "Есть ли что-то непростительное для тебя?",
                "Чему научили тебя наши отношения?"
            ],
            tasks: [
                {content: "Нарисуйте портреты друг друга", time: "2 минуты", icon: "🎨"},
                {content: "Создайте историю по очереди", time: "3 минуты", icon: "📖"},
                {content: "Напишите любовные записки", time: "5 минут", icon: "✉️"},
                {content: "Сделайте романтичное фото", icon: "📸"},
                {content: "Смотрите в глаза молча", time: "1 минута", icon: "👁️"},
                {content: "Спойте любимые песни", icon: "🎤"},
                {content: "Обнимитесь крепко-крепко", time: "30 секунд", icon: "🤗"},
                {content: "Потанцуйте вместе", time: "1 песня", icon: "💃"},
                {content: "Покажите детские фото", icon: "👶"},
                {content: "Сделайте массаж плеч", time: "2 минуты каждому", icon: "💆"},
                {content: "Игра 'Таинственное прикосновение': один с завязанными глазами угадывает предметы", time: "3 минуты", icon: "🙈"},
                {content: "Парная йога: примите позу 'двойного дерева' вместе", time: "1 минута", icon: "🧘‍♀️"},
                {content: "Игра 'Зеркало': один показывает движения, другой повторяет", time: "2 минуты", icon: "🪞"},
                {content: "Покормите друг друга с закрытыми глазами", time: "3 минуты", icon: "🍓"},
                {content: "Создайте 'банку воспоминаний': запишите 5 лучших совместных моментов", time: "10 минут", icon: "🏺"},
                {content: "Нарисуйте вместе одну картину четырьмя руками", time: "5 минут", icon: "🎨"},
                {content: "Сочините и спойте песню о вашей любви", time: "5 минут", icon: "🎵"},
                {content: "Создайте секретный язык жестов только для вас двоих", time: "5 минут", icon: "🤝"},
                {content: "Упражнение 'Падение': один падает назад, другой ловит", time: "2 минуты", icon: "🤸‍♀️"},
                {content: "Дышите синхронно 10 вдохов-выдохов", time: "2 минуты", icon: "💨"},
                {content: "Обменяйтесь одним секретом, которым никогда не делились", icon: "🤐"},
                {content: "Сделайте друг другу комплимент на разных языках", icon: "🗣️"},
                {content: "Изобразите друг друга без слов, пусть угадает", time: "3 минуты", icon: "🎭"},
                {content: "Станцуйте танец только руками сидя", time: "1 песня", icon: "👐"},
                {content: "Опишите цвет, не называя его - пусть партнер угадает", time: "2 минуты", icon: "🌈"},
                {content: "Нарисуйте совместный автопортрет не глядя на бумагу", time: "3 минуты", icon: "👫"},
                {content: "Спланируйте идеальные выходные вместе", time: "5 минут", icon: "📅"},
                {content: "Создайте список из 10 мест, которые хотите посетить вместе", time: "5 минут", icon: "🗺️"},
                {content: "Напишите письмо себе в будущее на годовщину", time: "10 минут", icon: "💌"},
                {content: "Недельный вызов: каждый день говорите по одному новому комплименту", time: "7 дней", icon: "📆"},
                {content: "Договоритесь попробовать новое хобби вместе в этом месяце", icon: "🆕"},
                {content: "Создайте традицию: что будете делать каждые выходные", icon: "🔄"}
            ],
            comparison: [
                "Кто из нас чаще опаздывает на встречи?",
                "Кто из нас более организованный?",
                "Кто из нас готовит лучше?",
                "Кто из нас более романтичный?",
                "Кто из нас чаще инициирует объятия?",
                "Кто из нас более спонтанный?",
                "Кто из нас лучше запоминает важные даты?",
                "Кто из нас более терпеливый?",
                "Кто из нас чаще говорит 'извини'?",
                "Кто из нас более смелый?",
                "Кто из нас лучше танцует?",
                "Кто из нас быстрее засыпает?",
                "Кто из нас чаще смеется?",
                "Кто из нас более щедрый?",
                "Кто из нас лучше водит машину?",
                "Кто из нас более эмоциональный?",
                "Кто из нас чаще забывает, где положил ключи?",
                "Кто из нас лучше разбирается в технике?",
                "Кто из нас более оптимистичный?",
                "Кто из нас чаще принимает решения в отношениях?",
                "Кто из нас лучше умеет экономить деньги?",
                "Кто из нас более чувствительный к критике?",
                "Кто из нас чаще мечтает?",
                "Кто из нас более активный в социальных сетях?",
                "Кто из нас лучше поддерживает в трудную минуту?",
                "Кто из нас чаще предлагает новые идеи для свиданий?",
                "Кто из нас более пунктуальный?",
                "Кто из нас лучше умеет хранить секреты?",
                "Кто из нас чаще говорит комплименты?",
                "Кто из нас более креативный?"
            ]
        };

        // Game state
        let currentLevel = null;
        let currentCardIndex = 0;
        let currentQuestions = [];
        let player1Name = "";
        let player2Name = "";
        let selectedChoice = null;
        let comparisonAnswers = [];

        // Utility functions
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function saveProgress() {
            const progress = {
                cardIndex: currentCardIndex,
                questions: currentQuestions,
                answers: comparisonAnswers,
                timestamp: Date.now()
            };
            localStorage.setItem(`progress_${currentLevel}`, JSON.stringify(progress));
        }

        function updateProgressIndicators() {
            const levels = [1, 2, 3, 'tasks', 'comparison'];

            levels.forEach(level => {
                const progress = localStorage.getItem(`progress_${level}`);
                let indicatorId;

                if (level === 'tasks') {
                    indicatorId = 'progressTasks';
                } else if (level === 'comparison') {
                    indicatorId = 'progressComparison';
                } else {
                    indicatorId = `progress${level}`;
                }

                const indicator = document.getElementById(indicatorId);

                if (progress) {
                    const data = JSON.parse(progress);
                    const totalQuestions = questions[level].length;
                    const currentCard = data.cardIndex || 0;
                    const progressPercent = Math.round((currentCard / totalQuestions) * 100);

                    if (currentCard >= totalQuestions - 1) {
                        indicator.textContent = '✓';
                        indicator.className = 'progress-indicator completed';
                    } else {
                        indicator.textContent = `${progressPercent}%`;
                        indicator.className = 'progress-indicator in-progress';
                    }
                } else {
                    indicator.textContent = '';
                    indicator.className = 'progress-indicator';
                }
            });
        }

        // Main game functions
        function startGame(level) {
            currentLevel = level;
            selectedChoice = null;

            if (level === 'comparison') {
                startComparisonMode();
                return;
            }

            currentQuestions = [...questions[level]];

            // Load saved progress
            const savedProgress = localStorage.getItem(`progress_${level}`);
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentCardIndex = progress.cardIndex || 0;
                if (progress.questions && progress.questions.length === currentQuestions.length) {
                    currentQuestions = progress.questions;
                } else {
                    currentQuestions = shuffleArray(currentQuestions);
                    saveProgress();
                }
            } else {
                currentCardIndex = 0;
                currentQuestions = shuffleArray(currentQuestions);
                saveProgress();
            }

            hideAllScreens();
            document.getElementById('gameScreen').classList.remove('hidden');

            const levelNames = {
                1: "Уровень 1",
                2: "Уровень 2",
                3: "Уровень 3",
                'tasks': "Задания"
            };

            document.getElementById('levelLabel').textContent = levelNames[level];
            showCard();
        }

        function startComparisonMode() {
            currentQuestions = [...questions.comparison];
            comparisonAnswers = [];

            const savedProgress = localStorage.getItem(`progress_comparison`);
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentCardIndex = progress.cardIndex || 0;
                comparisonAnswers = progress.answers || [];
                if (progress.questions && progress.questions.length === currentQuestions.length) {
                    currentQuestions = progress.questions;
                } else {
                    currentQuestions = shuffleArray(currentQuestions);
                    saveProgress();
                }
            } else {
                currentCardIndex = 0;
                currentQuestions = shuffleArray(currentQuestions);
                saveProgress();
            }

            hideAllScreens();
            document.getElementById('comparisonScreen').classList.remove('hidden');

            document.getElementById('player1ChoiceText').textContent = player1Name || 'Игрок 1';
            document.getElementById('player2ChoiceText').textContent = player2Name || 'Игрок 2';

            showComparisonCard();
        }

        function showCard() {
            const card = document.getElementById('card');
            const content = document.getElementById('cardContent');
            const current = currentQuestions[currentCardIndex];

            card.classList.remove('card-flip-in');
            setTimeout(() => {
                card.classList.add('card-flip-in');

                if (currentLevel === 'tasks') {
                    content.innerHTML = `
                        <div class="task-card">
                            <div class="task-icon">${current.icon}</div>
                            <div class="task-text">${current.content}</div>
                            ${current.time ? `<div class="task-time">⏱ ${current.time}</div>` : ''}
                        </div>
                    `;
                } else {
                    content.innerHTML = `<div class="question-text">${current}</div>`;
                }
            }, 50);

            document.getElementById('cardNumber').textContent = `${currentCardIndex + 1} / ${currentQuestions.length}`;

            const progress = ((currentCardIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            document.getElementById('prevBtn').disabled = currentCardIndex === 0;
        }

        function showComparisonCard() {
            const question = currentQuestions[currentCardIndex];
            document.getElementById('comparisonQuestion').textContent = question;
            document.getElementById('comparisonCardNumber').textContent = `${currentCardIndex + 1} / ${currentQuestions.length}`;

            const progress = ((currentCardIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('comparisonProgressBar').style.width = progress + '%';

            selectedChoice = null;
            document.getElementById('player1Choice').classList.remove('selected');
            document.getElementById('player2Choice').classList.remove('selected');
            document.getElementById('comparisonNextBtn').disabled = true;

            if (comparisonAnswers[currentCardIndex]) {
                selectedChoice = comparisonAnswers[currentCardIndex];
                const choiceBtn = selectedChoice === 1 ? 'player1Choice' : 'player2Choice';
                document.getElementById(choiceBtn).classList.add('selected');
                document.getElementById('comparisonNextBtn').disabled = false;
            }

            document.getElementById('comparisonPrevBtn').disabled = currentCardIndex === 0;
        }

        function makeChoice(choice) {
            selectedChoice = choice;
            comparisonAnswers[currentCardIndex] = choice;

            document.getElementById('player1Choice').classList.remove('selected');
            document.getElementById('player2Choice').classList.remove('selected');

            const choiceBtn = choice === 1 ? 'player1Choice' : 'player2Choice';
            document.getElementById(choiceBtn).classList.add('selected');

            document.getElementById('comparisonNextBtn').disabled = false;
            saveProgress();
        }

        function nextCard() {
            if (currentCardIndex < currentQuestions.length - 1) {
                currentCardIndex++;
                saveProgress();
                showCard();
            } else {
                const levelNames = {
                    1: "первый уровень",
                    2: "второй уровень",
                    3: "третий уровень",
                    'tasks': "специальные задания"
                };

                if (confirm(`Поздравляем! Вы прошли ${levelNames[currentLevel]}! 🎉\n\nВернуться в меню?`)) {
                    localStorage.removeItem(`progress_${currentLevel}`);
                    backToMenu();
                }
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                saveProgress();
                showCard();
            }
        }

        function nextComparisonCard() {
            if (currentCardIndex < currentQuestions.length - 1) {
                currentCardIndex++;
                saveProgress();
                showComparisonCard();
            } else {
                const player1Count = comparisonAnswers.filter(answer => answer === 1).length;
                const player2Count = comparisonAnswers.filter(answer => answer === 2).length;

                const player1NameDisplay = player1Name || 'Игрок 1';
                const player2NameDisplay = player2Name || 'Игрок 2';

                const result = `Результаты игры "Ты или Я?":\n\n${player1NameDisplay}: ${player1Count} раз\n${player2NameDisplay}: ${player2Count} раз\n\nСпасибо за игру! 💕`;

                if (confirm(result + '\n\nВернуться в меню?')) {
                    localStorage.removeItem(`progress_comparison`);
                    backToMenu();
                }
            }
        }

        function previousComparisonCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                saveProgress();
                showComparisonCard();
            }
        }

        function hideAllScreens() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('nameInputScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('comparisonScreen').classList.add('hidden');
        }

        function backToMenu() {
            hideAllScreens();
            document.getElementById('startScreen').classList.remove('hidden');
            updateProgressIndicators();
        }

        function showNameInput() {
            hideAllScreens();
            document.getElementById('nameInputScreen').classList.remove('hidden');

            const savedName1 = localStorage.getItem('player1Name');
            const savedName2 = localStorage.getItem('player2Name');

            if (savedName1) {
                document.getElementById('player1Name').value = savedName1;
                player1Name = savedName1;
            }
            if (savedName2) {
                document.getElementById('player2Name').value = savedName2;
                player2Name = savedName2;
            }
        }

        function saveNames() {
            const name1 = document.getElementById('player1Name').value.trim();
            const name2 = document.getElementById('player2Name').value.trim();

            if (name1) {
                player1Name = name1;
                localStorage.setItem('player1Name', name1);
            }
            if (name2) {
                player2Name = name2;
                localStorage.setItem('player2Name', name2);
            }

            backToMenu();

            if (name1 || name2) {
                const message = name1 && name2 ?
                    `Привет, ${name1} и ${name2}! 💕` :
                    `Привет, ${name1 || name2}! 💕`;

                const subtitle = document.querySelector('.subtitle');
                const originalText = subtitle.textContent;
                subtitle.textContent = message;
                subtitle.style.color = 'rgba(240, 147, 251, 0.9)';

                setTimeout(() => {
                    subtitle.textContent = originalText;
                    subtitle.style.color = '';
                }, 4000);
            }
        }

        // Initialize
        window.addEventListener('load', function() {
            createParticles();

            const savedName1 = localStorage.getItem('player1Name');
            const savedName2 = localStorage.getItem('player2Name');

            if (savedName1) player1Name = savedName1;
            if (savedName2) player2Name = savedName2;

            updateProgressIndicators();
        });

        // Touch improvements
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('dblclick', function(e) {
            e.preventDefault();
        });

        document.addEventListener('touchstart', function() {}, { passive: true });
    </script>
</body>
</html>
