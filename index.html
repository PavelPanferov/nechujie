<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ë–ª–∏–∂–µ - –ò–≥—Ä–∞ –¥–ª—è –ø–∞—Ä</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            --secondary-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #a8edea 100%);
            --accent-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ff9a9e 75%, #fecfef 100%);
            --glass-bg: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
            --text-light: rgba(255, 255, 255, 0.6);
            --card-shadow: 0 30px 80px rgba(102, 126, 234, 0.2);
            --border-glass: rgba(255, 255, 255, 0.2);
            --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #0a0118;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at center,
                rgba(102, 126, 234, 0.4) 0%,
                rgba(240, 147, 251, 0.3) 25%,
                rgba(255, 154, 158, 0.2) 50%,
                transparent 75%);
            animation: rotate 25s linear infinite;
            z-index: -2;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(240, 147, 251, 0.15) 0%, transparent 60%),
                radial-gradient(circle at 40% 60%, rgba(102, 126, 234, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Particles */
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            pointer-events: none;
        }

        .heart-particle {
            color: rgba(240, 147, 251, 0.7);
            animation: float 12s ease-in-out infinite;
        }

        .star-particle {
            color: rgba(255, 255, 255, 0.5);
            animation: twinkle 4s ease-in-out infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% {
                transform: translateY(-100px) translateX(50px) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        .container {
            width: 100%;
            max-width: 420px;
            position: relative;
            z-index: 10;
        }

        /* Screens */
        .screen {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--border-glass);
            border-radius: 32px;
            padding: 50px 35px;
            box-shadow: var(--card-shadow);
            animation: slideUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--primary-gradient);
            border-radius: 32px 32px 0 0;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Logo and title */
        .logo-container {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        .logo {
            font-size: 4em;
            margin-bottom: 20px;
            display: inline-block;
            animation: heartbeat 3s ease-in-out infinite;
            filter: drop-shadow(0 4px 12px rgba(240, 147, 251, 0.4));
        }

        @keyframes heartbeat {
            0%, 70%, 100% {
                transform: scale(1) rotate(0deg);
            }
            10% {
                transform: scale(1.15) rotate(-3deg);
            }
            20% {
                transform: scale(1.08) rotate(2deg);
            }
        }

        h1 {
            font-size: 3.2em;
            font-weight: 800;
            background: var(--primary-gradient);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 4s linear infinite;
            margin-bottom: 12px;
            letter-spacing: -0.03em;
        }

        @keyframes gradient {
            to { background-position: 200% center; }
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1.2em;
            letter-spacing: 3px;
            text-transform: uppercase;
            font-weight: 400;
            opacity: 0.9;
        }

        /* Level buttons */
        .level-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 30px;
        }

        .level-btn {
            width: 100%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            color: var(--text-primary);
            padding: 28px 24px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-align: left;
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.15);
        }

        .level-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent);
            transition: left 0.8s ease;
        }

        .level-btn:hover::before {
            left: 100%;
        }

        .level-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.25);
        }

        .level-btn:active {
            transform: translateY(2px);
        }

        .level-btn.special {
            background: linear-gradient(135deg,
                rgba(255, 154, 158, 0.15),
                rgba(168, 237, 234, 0.15));
            border-color: rgba(255, 154, 158, 0.3);
        }

        .level-icon {
            font-size: 2em;
            margin-bottom: 12px;
            display: block;
            filter: drop-shadow(0 2px 8px rgba(240, 147, 251, 0.3));
        }

        .level-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .level-desc {
            font-size: 0.95em;
            color: var(--text-light);
            opacity: 0.8;
            line-height: 1.4;
        }

        .progress-indicator {
            position: absolute;
            top: 16px;
            right: 20px;
            background: var(--primary-gradient);
            color: white;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.8em;
            font-weight: 600;
            min-width: 28px;
            text-align: center;
        }

        .progress-indicator.completed {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .progress-indicator.in-progress {
            background: linear-gradient(135deg, #FF9800, #f57c00);
        }

        /* Settings button */
        .settings-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-glass);
            color: var(--text-secondary);
            padding: 14px 28px;
            border-radius: 25px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
        }

        .settings-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        /* Game card */
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--border-glass);
            border-radius: 28px;
            padding: 45px 35px;
            min-height: 350px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%, rgba(240, 147, 251, 0.05) 100%);
            pointer-events: none;
        }

        .card-header {
            position: absolute;
            top: 20px;
            left: 25px;
            right: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 2;
        }

        .level-badge {
            background: var(--primary-gradient);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .card-counter {
            color: var(--text-light);
            font-size: 0.95em;
            font-weight: 500;
        }

        .question-text {
            color: var(--text-primary);
            font-size: 1.4em;
            line-height: 1.6;
            text-align: center;
            font-weight: 500;
            padding: 20px 10px;
            position: relative;
            z-index: 1;
            letter-spacing: -0.01em;
        }

        .task-card {
            background: var(--accent-gradient);
            color: var(--text-primary);
            padding: 35px 30px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(15px);
            position: relative;
            z-index: 1;
            box-shadow: 0 15px 40px rgba(168, 237, 234, 0.3);
        }

        .task-icon {
            font-size: 3.5em;
            margin-bottom: 18px;
            display: block;
            animation: iconFloat 5s ease-in-out infinite;
            filter: drop-shadow(0 4px 8px rgba(102, 126, 234, 0.2));
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-12px) rotate(8deg); }
        }

        .task-text {
            color: var(--text-primary);
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .task-time {
            color: rgba(26, 32, 44, 0.7);
            font-size: 0.95em;
            font-weight: 500;
        }

        /* Comparison mode */
        .comparison-choices {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 30px 0;
            position: relative;
            z-index: 1;
        }

        .choice-btn {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-glass);
            color: var(--text-primary);
            padding: 24px 28px;
            border-radius: 20px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .choice-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .choice-btn:hover {
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .choice-btn:hover::before {
            left: 100%;
        }

        .choice-btn.selected {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            transform: translateY(-2px) scale(1.02);
        }

        .player2-btn.selected {
            background: var(--secondary-gradient);
            box-shadow: 0 15px 40px rgba(255, 154, 158, 0.4);
        }

        /* Navigation */
        .nav-container {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 25px;
        }

        .nav-btn {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4em;
            transition: var(--transition);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.25);
        }

        .nav-btn:active {
            transform: translateY(1px);
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        .nav-btn.primary {
            background: var(--primary-gradient);
            border: none;
            color: white;
            font-size: 1.6em;
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.3);
        }

        /* Progress bar */
        .progress {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .progress::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 15px;
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progressShine 4s infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* Name input screen */
        .name-inputs {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 30px 0;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .input-group label {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .input-group input {
            padding: 16px 20px;
            border: 2px solid var(--border-glass);
            border-radius: 16px;
            font-size: 1em;
            font-family: inherit;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            transition: var(--transition);
            outline: none;
        }

        .input-group input:focus {
            border-color: rgba(102, 126, 234, 0.8);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .input-group input::placeholder {
            color: var(--text-light);
            opacity: 0.7;
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        /* Card animations */
        @keyframes cardFlipIn {
            from {
                transform: rotateY(90deg) scale(0.9);
                opacity: 0;
            }
            to {
                transform: rotateY(0) scale(1);
                opacity: 1;
            }
        }

        .card-flip-in {
            animation: cardFlipIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Mobile optimizations */
        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
                max-width: 100%;
            }

            .screen {
                padding: 35px 25px;
            }

            h1 {
                font-size: 2.8em;
            }

            .question-text {
                font-size: 1.3em;
            }

            .card {
                padding: 35px 25px;
                min-height: 320px;
            }

            .level-btn {
                padding: 24px 20px;
                font-size: 1em;
            }

            .nav-container {
                gap: 12px;
            }

            .nav-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2em;
            }
        }

        @media (hover: hover) {
            .level-btn:hover {
                transform: translateY(-6px);
                box-shadow: 0 25px 60px rgba(102, 126, 234, 0.3);
            }

            .choice-btn:hover {
                transform: translateY(-6px);
            }

            .nav-btn:hover {
                transform: translateY(-4px);
            }
        }
    </style>
</head>
<body>
    <div id="particles"></div>

    <div class="container">
        <!-- Start screen -->
        <div class="screen" id="startScreen">
            <div class="logo-container">
                <div class="logo">üíï</div>
                <h1>–ù–µ —á—É–∂–∏–µ</h1>
                <p class="subtitle">–ò–≥—Ä–∞ –¥–ª—è –ø–∞—Ä</p>
            </div>

            <div class="level-buttons">
                <button class="level-btn" onclick="startGame(1)" id="level1Btn">
                    <div class="level-icon">‚ú®</div>
                    <div class="level-title">–£—Ä–æ–≤–µ–Ω—å 1: –í–æ—Å–ø—Ä–∏—è—Ç–∏–µ</div>
                    <div class="level-desc">–£–∑–Ω–∞–π—Ç–µ –ø–µ—Ä–≤—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è</div>
                    <span class="progress-indicator" id="progress1"></span>
                </button>

                <button class="level-btn" onclick="startGame(2)" id="level2Btn">
                    <div class="level-icon">üíï</div>
                    <div class="level-title">–£—Ä–æ–≤–µ–Ω—å 2: –°–≤—è–∑—å</div>
                    <div class="level-desc">–°–æ–∑–¥–∞–π—Ç–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –±–ª–∏–∑–æ—Å—Ç—å</div>
                    <span class="progress-indicator" id="progress2"></span>
                </button>

                <button class="level-btn" onclick="startGame(3)" id="level3Btn">
                    <div class="level-icon">üåü</div>
                    <div class="level-title">–£—Ä–æ–≤–µ–Ω—å 3: –†–∞–∑–º—ã—à–ª–µ–Ω–∏—è</div>
                    <div class="level-desc">–û—Ç–∫—Ä–æ–π—Ç–µ –≥–ª—É–±–∏–Ω–Ω—ã–µ —á—É–≤—Å—Ç–≤–∞</div>
                    <span class="progress-indicator" id="progress3"></span>
                </button>

                <button class="level-btn special" onclick="startGame('tasks')" id="levelTasksBtn">
                    <div class="level-icon">üéØ</div>
                    <div class="level-title">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
                    <div class="level-desc">–¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–≤–æ–∏—Ö</div>
                    <span class="progress-indicator" id="progressTasks"></span>
                </button>

                <button class="level-btn" onclick="startGame('comparison')" id="levelComparisonBtn">
                    <div class="level-icon">üíë</div>
                    <div class="level-title">–¢—ã –∏–ª–∏ –Ø?</div>
                    <div class="level-desc">–£–≥–∞–¥–∞–π—Ç–µ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞</div>
                    <span class="progress-indicator" id="progressComparison"></span>
                </button>
            </div>

            <button class="settings-btn" onclick="showNameInput()">
                ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>
        </div>

        <!-- Name input screen -->
        <div class="screen hidden" id="nameInputScreen">
            <div class="logo-container">
                <div class="logo">üë•</div>
                <h1>–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ</h1>
                <p class="subtitle">–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?</p>
            </div>

            <div class="name-inputs">
                <div class="input-group">
                    <label for="player1Name">–ò–≥—Ä–æ–∫ 1:</label>
                    <input type="text" id="player1Name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="15">
                </div>
                <div class="input-group">
                    <label for="player2Name">–ò–≥—Ä–æ–∫ 2:</label>
                    <input type="text" id="player2Name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" maxlength="15">
                </div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" onclick="backToMenu()">‚Üê</button>
                <button class="nav-btn primary" onclick="saveNames()">‚úì</button>
            </div>
        </div>

        <!-- Game screen -->
        <div class="screen hidden" id="gameScreen">
            <div class="card" id="card">
                <div class="card-header">
                    <span class="level-badge" id="levelLabel"></span>
                    <span class="card-counter" id="cardNumber"></span>
                </div>
                <div id="cardContent"></div>
            </div>

            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" id="prevBtn" onclick="previousCard()">‚Üê</button>
                <button class="nav-btn" onclick="backToMenu()">üè†</button>
                <button class="nav-btn primary" onclick="nextCard()">‚Üí</button>
            </div>
        </div>

        <!-- Comparison screen -->
        <div class="screen hidden" id="comparisonScreen">
            <div class="card" id="comparisonCard">
                <div class="card-header">
                    <span class="level-badge">–¢—ã –∏–ª–∏ –Ø?</span>
                    <span class="card-counter" id="comparisonCardNumber"></span>
                </div>
                <div class="question-text" id="comparisonQuestion"></div>

                <div class="comparison-choices">
                    <button class="choice-btn player1-btn" id="player1Choice" onclick="makeChoice(1)">
                        <span id="player1ChoiceText">–ò–≥—Ä–æ–∫ 1</span>
                    </button>
                    <button class="choice-btn player2-btn" id="player2Choice" onclick="makeChoice(2)">
                        <span id="player2ChoiceText">–ò–≥—Ä–æ–∫ 2</span>
                    </button>
                </div>
            </div>

            <div class="progress">
                <div class="progress-bar" id="comparisonProgressBar"></div>
            </div>

            <div class="nav-container">
                <button class="nav-btn" id="comparisonPrevBtn" onclick="previousComparisonCard()">‚Üê</button>
                <button class="nav-btn" onclick="backToMenu()">üè†</button>
                <button class="nav-btn primary" id="comparisonNextBtn" onclick="nextComparisonCard()" disabled>‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        // Particle effects
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            if (!particlesContainer || particlesContainer.children.length > 0) return;

            for (let i = 0; i < 25; i++) {
                const isHeart = Math.random() > 0.6;
                const particle = document.createElement('div');
                particle.className = isHeart ? 'particle heart-particle' : 'particle star-particle';
                particle.innerHTML = isHeart ? ['üíï', 'üíñ', 'üíó', 'üíù'][Math.floor(Math.random() * 4)] : ['‚ú®', '‚≠ê', 'üåü'][Math.floor(Math.random() * 3)];
                particle.style.left = Math.random() * 100 + '%';
                particle.style.fontSize = Math.random() * 12 + 10 + 'px';

                const animationDuration = Math.random() * 8 + 12;
                const animationDelay = Math.random() * 10;

                if (isHeart) {
                    particle.style.animation = `float ${animationDuration}s ease-in-out infinite ${animationDelay}s`;
                } else {
                    particle.style.animation = `twinkle ${Math.random() * 3 + 3}s ease-in-out infinite ${animationDelay}s`;
                }

                particlesContainer.appendChild(particle);
            }
        }

        // Questions data
        const questions = {
            1: [
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, –∫–∞–∫–∞—è —É –º–µ–Ω—è –±—ã–ª–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –±—ã–ª(–∞) –±–µ–∑–æ—Ç–≤–µ—Ç–Ω–æ –≤–ª—é–±–ª–µ–Ω(–∞)?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, –º–Ω–µ –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å —Ä–∞–∑–±–∏–≤–∞–ª–∏ —Å–µ—Ä–¥—Ü–µ?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –±—ã–ª(–∞) –ø–æ–ø—É–ª—è—Ä–µ–Ω(–Ω–∞) –≤ —à–∫–æ–ª–µ?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, –º–Ω–µ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –±—ã—Ç—å –¥–æ–º–∞ –∏–ª–∏ –≥—É–ª—è—Ç—å?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è —ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç –∏–ª–∏ –∏–Ω—Ç—Ä–æ–≤–µ—Ä—Ç?",
                "–ö–∞–∫–æ–µ, –ø–æ-—Ç–≤–æ–µ–º—É, –º–æ–µ –ª—é–±–∏–º–æ–µ –±–ª—é–¥–æ?",
                "–ö–∞–∫–æ–π, –ø–æ-—Ç–≤–æ–µ–º—É, –º–æ–π –ª—é–±–∏–º—ã–π –Ω–∞–ø–∏—Ç–æ–∫?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –ª—é–±–ª—é —á–∏—Ç–∞—Ç—å –∫–Ω–∏–≥–∏?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –∏–≥—Ä–∞—é –≤ –≤–∏–¥–µ–æ–∏–≥—Ä—ã?",
                "–ö–∞–∫–æ–π, –ø–æ-—Ç–≤–æ–µ–º—É, –º–æ–π –ª—é–±–∏–º—ã–π —Ü–≤–µ—Ç?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –∂–∞–≤–æ—Ä–æ–Ω–æ–∫ –∏–ª–∏ —Å–æ–≤–∞?",
                "–ö–∞–∫—É—é –º—É–∑—ã–∫—É —è —Å–ª—É—à–∞—é —á–∞—â–µ –≤—Å–µ–≥–æ?",
                "–ö–∞–∫ —Ç—ã –¥—É–º–∞–µ—à—å, —è –ª—é–±–ª—é –ø—É—Ç–µ—à–µ—Å—Ç–≤–æ–≤–∞—Ç—å?",
                "–ö–∞–∫–æ–µ –º–æ–µ –ª—é–±–∏–º–æ–µ –≤—Ä–µ–º—è –≥–æ–¥–∞?",
                "–ï—Å–ª–∏ –±—ã —É —Ç–µ–±—è –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ—É–∂–∏–Ω–∞—Ç—å —Å –ª—é–±—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –≤ –º–∏—Ä–µ, –∫–æ–≥–æ –±—ã —Ç—ã –≤—ã–±—Ä–∞–ª(–∞)?",
                "–•–æ—Ç–µ–ª(–∞) –±—ã —Ç—ã —Å—Ç–∞—Ç—å –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–º(–æ–π)? –ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º?",
                "–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–∑–≤–æ–Ω–∏—Ç—å, —Ç—ã —Ä–µ–ø–µ—Ç–∏—Ä—É–µ—à—å —Ç–æ, —á—Ç–æ —Å–æ–±–∏—Ä–∞–µ—à—å—Å—è —Å–∫–∞–∑–∞—Ç—å?",
                "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è –æ–∑–Ω–∞—á–∞–µ—Ç ¬´–∏–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å¬ª?",
                "–ö–æ–≥–¥–∞ —Ç—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –ø–µ–ª(–∞) –¥–ª—è —Å–µ–±—è? –ê –¥–ª—è –∫–æ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ?",
                "–ï—Å–ª–∏ –±—ã —Ç—ã –º–æ–≥(–ª–∞) –¥–æ–∂–∏—Ç—å –¥–æ 90 –ª–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–∏–±–æ —Ä–∞–∑—É–º, –ª–∏–±–æ —Ç–µ–ª–æ 30-–ª–µ—Ç–Ω–µ–≥–æ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–Ω—è, —á—Ç–æ –±—ã —Ç—ã –≤—ã–±—Ä–∞–ª(–∞)?",
                "–ï—Å—Ç—å –ª–∏ —É —Ç–µ–±—è —Ç–∞–π–Ω–æ–µ –ø—Ä–µ–¥—á—É–≤—Å—Ç–≤–∏–µ –æ —Ç–æ–º, –∫–∞–∫ —Ç—ã —É–º—Ä–µ—à—å?",
                "–ù–∞–∑–æ–≤–∏ —Ç—Ä–∏ –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ —É –Ω–∞—Å —Å —Ç–æ–±–æ–π –æ–±—â–∏–µ.",
                "–ó–∞ —á—Ç–æ –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏ —Ç—ã –∏—Å–ø—ã—Ç—ã–≤–∞–µ—à—å –Ω–∞–∏–±–æ–ª—å—à—É—é –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å?",
                "–ï—Å–ª–∏ –±—ã —Ç—ã –º–æ–≥(–ª–∞) –∏–∑–º–µ–Ω–∏—Ç—å —á—Ç–æ-—Ç–æ –≤ —Ç–æ–º, –∫–∞–∫ —Ç–µ–±—è –≤–æ—Å–ø–∏—Ç—ã–≤–∞–ª–∏, —á—Ç–æ –±—ã —ç—Ç–æ –±—ã–ª–æ?",
                "–†–∞—Å—Å–∫–∞–∂–∏ –∏—Å—Ç–æ—Ä–∏—é —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏ –∑–∞ —á–µ—Ç—ã—Ä–µ –º–∏–Ω—É—Ç—ã, –≤–∫–ª—é—á–∏–≤ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.",
                "–ï—Å–ª–∏ –±—ã –∑–∞–≤—Ç—Ä–∞ —Ç—ã –ø—Ä–æ—Å–Ω—É–ª—Å—è(–ª–∞—Å—å) —Å –∫–∞–∫–∏–º-—Ç–æ –Ω–æ–≤—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º –∏–ª–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é, –∫–∞–∫–æ–π –±—ã –æ–Ω–∞ –±—ã–ª–∞?",
                "–ï—Å—Ç—å –ª–∏ —á—Ç–æ-—Ç–æ, –æ —á–µ–º —Ç—ã –º–µ—á—Ç–∞–µ—à—å —É–∂–µ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è? –ü–æ—á–µ–º—É —Ç—ã —ç—Ç–æ–≥–æ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–ª(–∞)?",
                "–ö–∞–∫–æ–µ —Ç–≤–æ–µ —Å–∞–º–æ–µ —Ü–µ–Ω–Ω–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ?",
                "–ö–∞–∫–æ–µ —Ç–≤–æ–µ —Å–∞–º–æ–µ —É–∂–∞—Å–Ω–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ?",
                "–ö–∞–∫—É—é —Ä–æ–ª—å –∏–≥—Ä–∞—é—Ç –ª—é–±–æ–≤—å –∏ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏?",
                "–ü–æ –æ—á–µ—Ä–µ–¥–∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–µ–º, —á—Ç–æ —Å—á–∏—Ç–∞–µ—Ç–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –ø—è—Ç—å—é –ø—É–Ω–∫—Ç–∞–º–∏.",
                "–ù–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–∞ –∏ –¥—Ä—É–∂–Ω–∞ —Ç–≤–æ—è —Å–µ–º—å—è? –ß—É–≤—Å—Ç–≤—É–µ—à—å –ª–∏ —Ç—ã, —á—Ç–æ –¥–µ—Ç—Å—Ç–≤–æ —É —Ç–µ–±—è –±—ã–ª–æ –±–æ–ª–µ–µ —Å—á–∞—Å—Ç–ª–∏–≤—ã–º, —á–µ–º —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ª—é–¥–µ–π?",
                "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º —Å–æ —Å–≤–æ–µ–π –º–∞—Ç–µ—Ä—å—é?"
            ],
            2: [
                "–ö–∞–∫–∏–º –±—ã–ª–æ —Ç–≤–æ–µ –ø–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ–±–æ –º–Ω–µ?",
                "–û —á–µ–º —Ç—ã —Å–æ–ª–≥–∞–ª(–∞) –º–Ω–µ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑?",
                "–ß—Ç–æ —Ç—ã —Å–∫—Ä—ã–≤–∞–ª(–∞) –æ—Ç –º–µ–Ω—è –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è?",
                "–ö–∞–∫–∏–µ —Å–∞–º—ã–µ —Å—Ç—Ä–∞–Ω–Ω—ã–µ –º—ã—Å–ª–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç —Ç–µ–±–µ –≤ –≥–æ–ª–æ–≤—É?",
                "–ö–∞–∫—É—é —Å–∞–º—É—é –±–æ–ª—å—à—É—é –æ—à–∏–±–∫—É —Ç—ã —Å–æ–≤–µ—Ä—à–∏–ª(–∞) –≤ –∂–∏–∑–Ω–∏?",
                "–ß—Ç–æ —Ç—ã –≤—Å–µ –µ—â–µ –ø—ã—Ç–∞–µ—à—å—Å—è –¥–æ–∫–∞–∑–∞—Ç—å —Å–µ–±–µ?",
                "–ß—Ç–æ —Å–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö —Å–æ –º–Ω–æ–π?",
                "–ö–∞–∫–æ–µ —Ç–≤–æ–µ —Å–∞–º–æ–µ —Ç–µ–ø–ª–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞?",
                "–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –∑–∞–≤–æ–µ–≤–∞—Ç—å —Ç–≤–æ–µ –¥–æ–≤–µ—Ä–∏–µ?",
                "–ö–∞–∫–æ–π –≥–ª–∞–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å –≤–æ–ª–Ω—É–µ—Ç —Ç–µ–±—è —Å–µ–π—á–∞—Å?",
                "–ß—Ç–æ —Å–¥–µ–ª–∞–ª–æ –±—ã —Ç–µ–±—è –µ—â–µ –±–ª–∏–∂–µ –∫–æ –º–Ω–µ?",
                "–ß–µ–≥–æ —Ç—ã –±–æ–∏—à—å—Å—è –≤ –Ω–∞—à–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
                "–ö–∞–∫–æ–π –º–æ–º–µ–Ω—Ç —Å—Ç–∞–ª –ø–µ—Ä–µ–ª–æ–º–Ω—ã–º –¥–ª—è –Ω–∞—Å?",
                "–ß—Ç–æ –±—ã —Ç—ã –∏–∑–º–µ–Ω–∏–ª(–∞) –≤ –Ω–∞—à–µ–º –æ–±—â–µ–Ω–∏–∏?",
                "–ö–∞–∫–∞—è –º–æ—è –ø—Ä–∏–≤—ã—á–∫–∞ —Ç–µ–±—è —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç?",
                "–ö–∞–∫–∏–µ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å –≥–ª–∞–≤–Ω—ã–µ —Ü–µ–ª–∏ –∏ —Å—Ç—Ä–µ–º–ª–µ–Ω–∏—è?",
                "–ß—Ç–æ —Ç–µ–±—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∏–∑ —Ç–æ–≥–æ, —á–µ–º —Ç—ã –Ω–µ –∑–∞–Ω–∏–º–∞–ª—Å—è(–ª–∞—Å—å) –≤ –ø—Ä–æ—à–ª–æ–º –≥–æ–¥—É?",
                "–ö–∞–∫–æ–π —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π —Å—Ç—Ä–µ—Å—Å –≤ —Ç–≤–æ–µ–π –∂–∏–∑–Ω–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?",
                "–ö—Ç–æ —Ç–≤–æ–∏ —Å–∞–º—ã–µ –±–ª–∏–∑–∫–∏–µ –¥—Ä—É–∑—å—è? –†–∞—Å—Å–∫–∞–∂–∏ –æ –Ω–∏—Ö.",
                "–ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏ —Ç–µ–±—è –∫–∞–∫ –ª–∏—á–Ω–æ—Å—Ç—å?",
                "–ö–∞–∫–∞—è —Ç–≤–æ—è —Å–∞–º–∞—è –∑–∞–≤–µ—Ç–Ω–∞—è –º–µ—á—Ç–∞ –Ω–∞ –±—É–¥—É—â–µ–µ?",
                "–ß—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–±—è —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –∂–∏–≤—ã–º(–æ–π)?",
                "–ö–∞–∫ —Ç—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è —Å —Ç—Ä—É–¥–Ω—ã–º–∏ –≤—Ä–µ–º–µ–Ω–∞–º–∏?",
                "–†–∞—Å—Å–∫–∞–∂–∏ –æ –º–æ–º–µ–Ω—Ç–µ, –∫–æ–≥–¥–∞ —Ç—ã —á—É–≤—Å—Ç–≤–æ–≤–∞–ª(–∞) —Å–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ –ª—é–±–∏–º—ã–º(–æ–π) –º–Ω–æ–π.",
                "–ö–∞–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ –º–Ω–µ —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
                "–ö–æ–≥–¥–∞ —Ç—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –≥–æ—Ä–¥–∏–ª—Å—è(–ª–∞—Å—å) –º–Ω–æ–π?",
                "–ö–∞–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –±—ã–ª –¥–ª—è —Ç–µ–±—è —Å–∞–º—ã–º —Å—á–∞—Å—Ç–ª–∏–≤—ã–º?",
                "–ó–∞ —á—Ç–æ —Ç—ã –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω(–Ω–∞) –º–Ω–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
                "–ß—Ç–æ —è –¥–µ–ª–∞—é, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–±—è —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –æ—Å–æ–±–µ–Ω–Ω—ã–º(–æ–π)?",
                "–ü–µ—Ä–µ–¥ –∫–µ–º —Ç—ã –ø–æ–∑–≤–æ–Ω–∏–ª –±—ã, –µ—Å–ª–∏ –±—ã —É–∑–Ω–∞–ª, —á—Ç–æ —É–º—Ä–µ—à—å —á–µ—Ä–µ–∑ —á–∞—Å?",
                "–ü–æ–¥–µ–ª–∏—Å—å –ª–∏—á–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π –∏ –ø–æ–ø—Ä–æ—Å–∏ —É –ø–∞—Ä—Ç–Ω–µ—Ä–∞ —Å–æ–≤–µ—Ç–∞.",
                "–ï—Å–ª–∏ –±—ã —Ç—ã –ø–æ–¥—Ä—É–∂–∏–ª—Å—è —Å–æ –º–Ω–æ–π, —á—Ç–æ –±—ã–ª–æ –±—ã –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —è –∑–Ω–∞–ª(–∞)?",
                "–°–∫–∞–∂–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—É, —á—Ç–æ —Ç–µ–±–µ –≤ –Ω–µ–º –Ω—Ä–∞–≤–∏—Ç—Å—è; –±—É–¥—å –æ—á–µ–Ω—å —á–µ—Å—Ç–Ω—ã–º(–æ–π).",
                "–ü–æ–¥–µ–ª–∏—Å—å –Ω–µ–ª–æ–≤–∫–∏–º –º–æ–º–µ–Ω—Ç–æ–º –∏–∑ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏.",
                "–ö–æ–≥–¥–∞ —Ç—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –ø–ª–∞–∫–∞–ª(–∞) –ø–µ—Ä–µ–¥ –¥—Ä—É–≥–∏–º —á–µ–ª–æ–≤–µ–∫–æ–º? –ê –æ–¥–∏–Ω?",
                "–ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–ª–∏—à–∫–æ–º —Å–µ—Ä—å–µ–∑–Ω–æ, —á—Ç–æ–±—ã —à—É—Ç–∏—Ç—å –æ–± —ç—Ç–æ–º?"
            ],
            3: [
                "–ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å –≤ —Å–µ–±–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?",
                "–ü–µ—Ä–µ–¥ –∫–µ–º —Ç—ã —Ö–æ—á–µ—à—å –∏–∑–≤–∏–Ω–∏—Ç—å—Å—è?",
                "–ß—Ç–æ –≤–æ –º–Ω–µ —Ç–µ–±—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —É–¥–∏–≤–∏–ª–æ?",
                "–ö–∞–∫–∞—è —É –º–µ–Ω—è —Å—É–ø–µ—Ä—Å–∏–ª–∞ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
                "–ß—Ç–æ –º–Ω–µ —Å—Ç–æ–∏—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å?",
                "–ß—Ç–æ —Ç—ã —É–∑–Ω–∞–ª(–∞) –æ —Å–µ–±–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–∞—à–∏–º –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º?",
                "–ö–∞–∫–æ–π –≤–æ–ø—Ä–æ—Å –±—ã–ª —Å–∞–º—ã–º —Å–ª–æ–∂–Ω—ã–º –¥–ª—è —Ç–µ–±—è?",
                "–ß—Ç–æ –±—ã–ª–æ –±—ã –∏–¥–µ–∞–ª—å–Ω—ã–º –ø–æ–¥–∞—Ä–∫–æ–º –¥–ª—è –º–µ–Ω—è?",
                "–ß—Ç–æ –º–Ω–µ –Ω—É–∂–Ω–æ —É—Å–ª—ã—à–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?",
                "–ü–æ—á–µ–º—É –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏—Å—å –∏–º–µ–Ω–Ω–æ —Å–µ–π—á–∞—Å?",
                "–ß—Ç–æ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –≤–º–µ—Å—Ç–µ?",
                "–ß—Ç–æ –≤–æ –º–Ω–µ —Å–∞–º–æ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–º–∏–º–æ –≤–Ω–µ—à–Ω–æ—Å—Ç–∏?",
                "–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞—à–∞ –∂–∏–∑–Ω—å —á–µ—Ä–µ–∑ 10 –ª–µ—Ç?",
                "–ï—Å—Ç—å –ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø—Ä–æ—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ –¥–ª—è —Ç–µ–±—è?",
                "–ß–µ–º—É –Ω–∞—É—á–∏–ª–∏ —Ç–µ–±—è –Ω–∞—à–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è?"
            ],
            tasks: [
                {content: "–ù–∞—Ä–∏—Å—É–π—Ç–µ –ø–æ—Ä—Ç—Ä–µ—Ç—ã –¥—Ä—É–≥ –¥—Ä—É–≥–∞", time: "2 –º–∏–Ω—É—Ç—ã", icon: "üé®"},
                {content: "–°–æ–∑–¥–∞–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –ø–æ –æ—á–µ—Ä–µ–¥–∏", time: "3 –º–∏–Ω—É—Ç—ã", icon: "üìñ"},
                {content: "–ù–∞–ø–∏—à–∏—Ç–µ –ª—é–±–æ–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∫–∏", time: "5 –º–∏–Ω—É—Ç", icon: "‚úâÔ∏è"},
                {content: "–°–¥–µ–ª–∞–π—Ç–µ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–µ —Ñ–æ—Ç–æ", icon: "üì∏"},
                {content: "–°–º–æ—Ç—Ä–∏—Ç–µ –≤ –≥–ª–∞–∑–∞ –º–æ–ª—á–∞", time: "1 –º–∏–Ω—É—Ç–∞", icon: "üëÅÔ∏è"},
                {content: "–°–ø–æ–π—Ç–µ –ª—é–±–∏–º—ã–µ –ø–µ—Å–Ω–∏", icon: "üé§"},
                {content: "–û–±–Ω–∏–º–∏—Ç–µ—Å—å –∫—Ä–µ–ø–∫–æ-–∫—Ä–µ–ø–∫–æ", time: "30 —Å–µ–∫—É–Ω–¥", icon: "ü§ó"},
                {content: "–ü–æ—Ç–∞–Ω—Ü—É–π—Ç–µ –≤–º–µ—Å—Ç–µ", time: "1 –ø–µ—Å–Ω—è", icon: "üíÉ"},
                {content: "–ü–æ–∫–∞–∂–∏—Ç–µ –¥–µ—Ç—Å–∫–∏–µ —Ñ–æ—Ç–æ", icon: "üë∂"},
                {content: "–°–¥–µ–ª–∞–π—Ç–µ –º–∞—Å—Å–∞–∂ –ø–ª–µ—á", time: "2 –º–∏–Ω—É—Ç—ã –∫–∞–∂–¥–æ–º—É", icon: "üíÜ"},
                {content: "–ò–≥—Ä–∞ '–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–∏–µ': –æ–¥–∏–Ω —Å –∑–∞–≤—è–∑–∞–Ω–Ω—ã–º–∏ –≥–ª–∞–∑–∞–º–∏ —É–≥–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç—ã", time: "3 –º–∏–Ω—É—Ç—ã", icon: "üôà"},
                {content: "–ü–∞—Ä–Ω–∞—è –π–æ–≥–∞: –ø—Ä–∏–º–∏—Ç–µ –ø–æ–∑—É '–¥–≤–æ–π–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞' –≤–º–µ—Å—Ç–µ", time: "1 –º–∏–Ω—É—Ç–∞", icon: "üßò‚Äç‚ôÄÔ∏è"},
                {content: "–ò–≥—Ä–∞ '–ó–µ—Ä–∫–∞–ª–æ': –æ–¥–∏–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è, –¥—Ä—É–≥–æ–π –ø–æ–≤—Ç–æ—Ä—è–µ—Ç", time: "2 –º–∏–Ω—É—Ç—ã", icon: "ü™û"},
                {content: "–ü–æ–∫–æ—Ä–º–∏—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏", time: "3 –º–∏–Ω—É—Ç—ã", icon: "üçì"},
                {content: "–°–æ–∑–¥–∞–π—Ç–µ '–±–∞–Ω–∫—É –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π': –∑–∞–ø–∏—à–∏—Ç–µ 5 –ª—É—á—à–∏—Ö —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤", time: "10 –º–∏–Ω—É—Ç", icon: "üè∫"},
                {content: "–ù–∞—Ä–∏—Å—É–π—Ç–µ –≤–º–µ—Å—Ç–µ –æ–¥–Ω—É –∫–∞—Ä—Ç–∏–Ω—É —á–µ—Ç—ã—Ä—å–º—è —Ä—É–∫–∞–º–∏", time: "5 –º–∏–Ω—É—Ç", icon: "üé®"},
                {content: "–°–æ—á–∏–Ω–∏—Ç–µ –∏ —Å–ø–æ–π—Ç–µ –ø–µ—Å–Ω—é –æ –≤–∞—à–µ–π –ª—é–±–≤–∏", time: "5 –º–∏–Ω—É—Ç", icon: "üéµ"},
                {content: "–°–æ–∑–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —è–∑—ã–∫ –∂–µ—Å—Ç–æ–≤ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∞—Å –¥–≤–æ–∏—Ö", time: "5 –º–∏–Ω—É—Ç", icon: "ü§ù"},
                {content: "–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ '–ü–∞–¥–µ–Ω–∏–µ': –æ–¥–∏–Ω –ø–∞–¥–∞–µ—Ç –Ω–∞–∑–∞–¥, –¥—Ä—É–≥–æ–π –ª–æ–≤–∏—Ç", time: "2 –º–∏–Ω—É—Ç—ã", icon: "ü§∏‚Äç‚ôÄÔ∏è"},
                {content: "–î—ã—à–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ 10 –≤–¥–æ—Ö–æ–≤-–≤—ã–¥–æ—Ö–æ–≤", time: "2 –º–∏–Ω—É—Ç—ã", icon: "üí®"},
                {content: "–û–±–º–µ–Ω—è–π—Ç–µ—Å—å –æ–¥–Ω–∏–º —Å–µ–∫—Ä–µ—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–º –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–µ–ª–∏–ª–∏—Å—å", icon: "ü§ê"},
                {content: "–°–¥–µ–ª–∞–π—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥—É –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö", icon: "üó£Ô∏è"},
                {content: "–ò–∑–æ–±—Ä–∞–∑–∏—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –±–µ–∑ —Å–ª–æ–≤, –ø—É—Å—Ç—å —É–≥–∞–¥–∞–µ—Ç", time: "3 –º–∏–Ω—É—Ç—ã", icon: "üé≠"},
                {content: "–°—Ç–∞–Ω—Ü—É–π—Ç–µ —Ç–∞–Ω–µ—Ü —Ç–æ–ª—å–∫–æ —Ä—É–∫–∞–º–∏ —Å–∏–¥—è", time: "1 –ø–µ—Å–Ω—è", icon: "üëê"},
                {content: "–û–ø–∏—à–∏—Ç–µ —Ü–≤–µ—Ç, –Ω–µ –Ω–∞–∑—ã–≤–∞—è –µ–≥–æ - –ø—É—Å—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä —É–≥–∞–¥–∞–µ—Ç", time: "2 –º–∏–Ω—É—Ç—ã", icon: "üåà"},
                {content: "–ù–∞—Ä–∏—Å—É–π—Ç–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ–ø–æ—Ä—Ç—Ä–µ—Ç –Ω–µ –≥–ª—è–¥—è –Ω–∞ –±—É–º–∞–≥—É", time: "3 –º–∏–Ω—É—Ç—ã", icon: "üë´"},
                {content: "–°–ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∏–¥–µ–∞–ª—å–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –≤–º–µ—Å—Ç–µ", time: "5 –º–∏–Ω—É—Ç", icon: "üìÖ"},
                {content: "–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–∑ 10 –º–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç–∏—Ç–µ –ø–æ—Å–µ—Ç–∏—Ç—å –≤–º–µ—Å—Ç–µ", time: "5 –º–∏–Ω—É—Ç", icon: "üó∫Ô∏è"},
                {content: "–ù–∞–ø–∏—à–∏—Ç–µ –ø–∏—Å—å–º–æ —Å–µ–±–µ –≤ –±—É–¥—É—â–µ–µ –Ω–∞ –≥–æ–¥–æ–≤—â–∏–Ω—É", time: "10 –º–∏–Ω—É—Ç", icon: "üíå"},
                {content: "–ù–µ–¥–µ–ª—å–Ω—ã–π –≤—ã–∑–æ–≤: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≥–æ–≤–æ—Ä–∏—Ç–µ –ø–æ –æ–¥–Ω–æ–º—É –Ω–æ–≤–æ–º—É –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—É", time: "7 –¥–Ω–µ–π", icon: "üìÜ"},
                {content: "–î–æ–≥–æ–≤–æ—Ä–∏—Ç–µ—Å—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ —Ö–æ–±–±–∏ –≤–º–µ—Å—Ç–µ –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ", icon: "üÜï"},
                {content: "–°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∞–¥–∏—Ü–∏—é: —á—Ç–æ –±—É–¥–µ—Ç–µ –¥–µ–ª–∞—Ç—å –∫–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ", icon: "üîÑ"}
            ],
            comparison: [
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç –Ω–∞ –≤—Å—Ç—Ä–µ—á–∏?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –≥–æ—Ç–æ–≤–∏—Ç –ª—É—á—à–µ?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ–±—ä—è—Ç–∏—è?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –¥–∞—Ç—ã?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –≥–æ–≤–æ—Ä–∏—Ç '–∏–∑–≤–∏–Ω–∏'?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —Å–º–µ–ª—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ —Ç–∞–Ω—Ü—É–µ—Ç?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±—ã—Å—Ç—Ä–µ–µ –∑–∞—Å—ã–ø–∞–µ—Ç?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ —Å–º–µ–µ—Ç—Å—è?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —â–µ–¥—Ä—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ –≤–æ–¥–∏—Ç –º–∞—à–∏–Ω—É?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –∑–∞–±—ã–≤–∞–µ—Ç, –≥–¥–µ –ø–æ–ª–æ–∂–∏–ª –∫–ª—é—á–∏?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Ç–µ—Ö–Ω–∏–∫–µ?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ —É–º–µ–µ—Ç —ç–∫–æ–Ω–æ–º–∏—Ç—å –¥–µ–Ω—å–≥–∏?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –∫ –∫—Ä–∏—Ç–∏–∫–µ?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –º–µ—á—Ç–∞–µ—Ç?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ –∞–∫—Ç–∏–≤–Ω—ã–π –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–æ–≤—ã–µ –∏–¥–µ–∏ –¥–ª—è —Å–≤–∏–¥–∞–Ω–∏–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ –ø—É–Ω–∫—Ç—É–∞–ª—å–Ω—ã–π?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –ª—É—á—à–µ —É–º–µ–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å —á–∞—â–µ –≥–æ–≤–æ—Ä–∏—Ç –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã?",
                "–ö—Ç–æ –∏–∑ –Ω–∞—Å –±–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π?"
            ]
        };

        // Game state
        let currentLevel = null;
        let currentCardIndex = 0;
        let currentQuestions = [];
        let player1Name = "";
        let player2Name = "";
        let selectedChoice = null;
        let comparisonAnswers = [];

        // Utility functions
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function saveProgress() {
            const progress = {
                cardIndex: currentCardIndex,
                questions: currentQuestions,
                answers: comparisonAnswers,
                timestamp: Date.now()
            };
            localStorage.setItem(`progress_${currentLevel}`, JSON.stringify(progress));
        }

        function updateProgressIndicators() {
            const levels = [1, 2, 3, 'tasks', 'comparison'];

            levels.forEach(level => {
                const progress = localStorage.getItem(`progress_${level}`);
                let indicatorId;

                if (level === 'tasks') {
                    indicatorId = 'progressTasks';
                } else if (level === 'comparison') {
                    indicatorId = 'progressComparison';
                } else {
                    indicatorId = `progress${level}`;
                }

                const indicator = document.getElementById(indicatorId);

                if (progress) {
                    const data = JSON.parse(progress);
                    const totalQuestions = questions[level].length;
                    const currentCard = data.cardIndex || 0;
                    const progressPercent = Math.round((currentCard / totalQuestions) * 100);

                    if (currentCard >= totalQuestions - 1) {
                        indicator.textContent = '‚úì';
                        indicator.className = 'progress-indicator completed';
                    } else {
                        indicator.textContent = `${progressPercent}%`;
                        indicator.className = 'progress-indicator in-progress';
                    }
                } else {
                    indicator.textContent = '';
                    indicator.className = 'progress-indicator';
                }
            });
        }

        // Main game functions
        function startGame(level) {
            currentLevel = level;
            selectedChoice = null;

            if (level === 'comparison') {
                startComparisonMode();
                return;
            }

            currentQuestions = [...questions[level]];

            // Load saved progress
            const savedProgress = localStorage.getItem(`progress_${level}`);
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentCardIndex = progress.cardIndex || 0;
                if (progress.questions && progress.questions.length === currentQuestions.length) {
                    currentQuestions = progress.questions;
                } else {
                    currentQuestions = shuffleArray(currentQuestions);
                    saveProgress();
                }
            } else {
                currentCardIndex = 0;
                currentQuestions = shuffleArray(currentQuestions);
                saveProgress();
            }

            hideAllScreens();
            document.getElementById('gameScreen').classList.remove('hidden');

            const levelNames = {
                1: "–£—Ä–æ–≤–µ–Ω—å 1",
                2: "–£—Ä–æ–≤–µ–Ω—å 2",
                3: "–£—Ä–æ–≤–µ–Ω—å 3",
                'tasks': "–ó–∞–¥–∞–Ω–∏—è"
            };

            document.getElementById('levelLabel').textContent = levelNames[level];
            showCard();
        }

        function startComparisonMode() {
            currentQuestions = [...questions.comparison];
            comparisonAnswers = [];

            const savedProgress = localStorage.getItem(`progress_comparison`);
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentCardIndex = progress.cardIndex || 0;
                comparisonAnswers = progress.answers || [];
                if (progress.questions && progress.questions.length === currentQuestions.length) {
                    currentQuestions = progress.questions;
                } else {
                    currentQuestions = shuffleArray(currentQuestions);
                    saveProgress();
                }
            } else {
                currentCardIndex = 0;
                currentQuestions = shuffleArray(currentQuestions);
                saveProgress();
            }

            hideAllScreens();
            document.getElementById('comparisonScreen').classList.remove('hidden');

            document.getElementById('player1ChoiceText').textContent = player1Name || '–ò–≥—Ä–æ–∫ 1';
            document.getElementById('player2ChoiceText').textContent = player2Name || '–ò–≥—Ä–æ–∫ 2';

            showComparisonCard();
        }

        function showCard() {
            const card = document.getElementById('card');
            const content = document.getElementById('cardContent');
            const current = currentQuestions[currentCardIndex];

            card.classList.remove('card-flip-in');
            setTimeout(() => {
                card.classList.add('card-flip-in');

                if (currentLevel === 'tasks') {
                    content.innerHTML = `
                        <div class="task-card">
                            <div class="task-icon">${current.icon}</div>
                            <div class="task-text">${current.content}</div>
                            ${current.time ? `<div class="task-time">‚è± ${current.time}</div>` : ''}
                        </div>
                    `;
                } else {
                    content.innerHTML = `<div class="question-text">${current}</div>`;
                }
            }, 50);

            document.getElementById('cardNumber').textContent = `${currentCardIndex + 1} / ${currentQuestions.length}`;

            const progress = ((currentCardIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';

            document.getElementById('prevBtn').disabled = currentCardIndex === 0;
        }

        function showComparisonCard() {
            const question = currentQuestions[currentCardIndex];
            document.getElementById('comparisonQuestion').textContent = question;
            document.getElementById('comparisonCardNumber').textContent = `${currentCardIndex + 1} / ${currentQuestions.length}`;

            const progress = ((currentCardIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('comparisonProgressBar').style.width = progress + '%';

            selectedChoice = null;
            document.getElementById('player1Choice').classList.remove('selected');
            document.getElementById('player2Choice').classList.remove('selected');
            document.getElementById('comparisonNextBtn').disabled = true;

            if (comparisonAnswers[currentCardIndex]) {
                selectedChoice = comparisonAnswers[currentCardIndex];
                const choiceBtn = selectedChoice === 1 ? 'player1Choice' : 'player2Choice';
                document.getElementById(choiceBtn).classList.add('selected');
                document.getElementById('comparisonNextBtn').disabled = false;
            }

            document.getElementById('comparisonPrevBtn').disabled = currentCardIndex === 0;
        }

        function makeChoice(choice) {
            selectedChoice = choice;
            comparisonAnswers[currentCardIndex] = choice;

            document.getElementById('player1Choice').classList.remove('selected');
            document.getElementById('player2Choice').classList.remove('selected');

            const choiceBtn = choice === 1 ? 'player1Choice' : 'player2Choice';
            document.getElementById(choiceBtn).classList.add('selected');

            document.getElementById('comparisonNextBtn').disabled = false;
            saveProgress();
        }

        function nextCard() {
            if (currentCardIndex < currentQuestions.length - 1) {
                currentCardIndex++;
                saveProgress();
                showCard();
            } else {
                const levelNames = {
                    1: "–ø–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å",
                    2: "–≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å",
                    3: "—Ç—Ä–µ—Ç–∏–π —É—Ä–æ–≤–µ–Ω—å",
                    'tasks': "—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è"
                };

                if (confirm(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø—Ä–æ—à–ª–∏ ${levelNames[currentLevel]}! üéâ\n\n–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é?`)) {
                    localStorage.removeItem(`progress_${currentLevel}`);
                    backToMenu();
                }
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                saveProgress();
                showCard();
            }
        }

        function nextComparisonCard() {
            if (currentCardIndex < currentQuestions.length - 1) {
                currentCardIndex++;
                saveProgress();
                showComparisonCard();
            } else {
                const player1Count = comparisonAnswers.filter(answer => answer === 1).length;
                const player2Count = comparisonAnswers.filter(answer => answer === 2).length;

                const player1NameDisplay = player1Name || '–ò–≥—Ä–æ–∫ 1';
                const player2NameDisplay = player2Name || '–ò–≥—Ä–æ–∫ 2';

                const result = `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã "–¢—ã –∏–ª–∏ –Ø?":\n\n${player1NameDisplay}: ${player1Count} —Ä–∞–∑\n${player2NameDisplay}: ${player2Count} —Ä–∞–∑\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–≥—Ä—É! üíï`;

                if (confirm(result + '\n\n–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é?')) {
                    localStorage.removeItem(`progress_comparison`);
                    backToMenu();
                }
            }
        }

        function previousComparisonCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                saveProgress();
                showComparisonCard();
            }
        }

        function hideAllScreens() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('nameInputScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('comparisonScreen').classList.add('hidden');
        }

        function backToMenu() {
            hideAllScreens();
            document.getElementById('startScreen').classList.remove('hidden');
            updateProgressIndicators();
        }

        function showNameInput() {
            hideAllScreens();
            document.getElementById('nameInputScreen').classList.remove('hidden');

            const savedName1 = localStorage.getItem('player1Name');
            const savedName2 = localStorage.getItem('player2Name');

            if (savedName1) {
                document.getElementById('player1Name').value = savedName1;
                player1Name = savedName1;
            }
            if (savedName2) {
                document.getElementById('player2Name').value = savedName2;
                player2Name = savedName2;
            }
        }

        function saveNames() {
            const name1 = document.getElementById('player1Name').value.trim();
            const name2 = document.getElementById('player2Name').value.trim();

            if (name1) {
                player1Name = name1;
                localStorage.setItem('player1Name', name1);
            }
            if (name2) {
                player2Name = name2;
                localStorage.setItem('player2Name', name2);
            }

            backToMenu();

            if (name1 || name2) {
                const message = name1 && name2 ?
                    `–ü—Ä–∏–≤–µ—Ç, ${name1} –∏ ${name2}! üíï` :
                    `–ü—Ä–∏–≤–µ—Ç, ${name1 || name2}! üíï`;

                const subtitle = document.querySelector('.subtitle');
                const originalText = subtitle.textContent;
                subtitle.textContent = message;
                subtitle.style.color = 'rgba(240, 147, 251, 0.9)';

                setTimeout(() => {
                    subtitle.textContent = originalText;
                    subtitle.style.color = '';
                }, 4000);
            }
        }

        // Initialize
        window.addEventListener('load', function() {
            createParticles();

            const savedName1 = localStorage.getItem('player1Name');
            const savedName2 = localStorage.getItem('player2Name');

            if (savedName1) player1Name = savedName1;
            if (savedName2) player2Name = savedName2;

            updateProgressIndicators();
        });

        // Touch improvements
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('dblclick', function(e) {
            e.preventDefault();
        });

        document.addEventListener('touchstart', function() {}, { passive: true });
    </script>
</body>
</html>
